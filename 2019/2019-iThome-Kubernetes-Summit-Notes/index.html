<!DOCTYPE html>
<html class="theme-next gemini use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
  <meta name="google-site-verification" content="googlea44f14c1ae61c18a.html">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">
<link rel="stylesheet" href="/css/main.css?v=7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-pohsien/apple-touch-icon-pohsien.png?v=7.1.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-pohsien/favicon-32x32-pohsien.png?v=7.1.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-pohsien/favicon-16x16-pohsien.png?v=7.1.1">
  <link rel="mask-icon" href="/images/favicon-pohsien/favicon.ico?v=7.1.1" color="#222">
<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
  <meta name="description" content="這次是第一次參加iThome Kubernetes Summit，當初看到早鳥票釋出就直接買了($2400左右)，以一天的Conference來說不算便宜，但是能夠去學習學習增廣見聞也是值得的。 結果買票之後才得知我們社群Cloud Native Taiwan User Group(CNTUG)也有去擺攤，雖然是付費票，但是還是去支援了一下社群攤位xD。 上午場都在跟附近社群交流、逛攤位以及顧社群">
<meta name="keywords" content="2019, kubernetes summit, ithome">
<meta property="og:type" content="article">
<meta property="og:title" content="iThome Kubernetes Summit 2019心得">
<meta property="og:url" content="https://pohsienshih.github.io/2019/2019-iThome-Kubernetes-Summit-Notes/index.html">
<meta property="og:site_name" content="Pohsien Workspace">
<meta property="og:description" content="這次是第一次參加iThome Kubernetes Summit，當初看到早鳥票釋出就直接買了($2400左右)，以一天的Conference來說不算便宜，但是能夠去學習學習增廣見聞也是值得的。 結果買票之後才得知我們社群Cloud Native Taiwan User Group(CNTUG)也有去擺攤，雖然是付費票，但是還是去支援了一下社群攤位xD。 上午場都在跟附近社群交流、逛攤位以及顧社群">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://i.imgur.com/AtBS9Xw.jpg">
<meta property="og:image" content="https://i.imgur.com/kBoSZXs.jpg">
<meta property="og:updated_time" content="2019-12-12T13:31:18.939Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iThome Kubernetes Summit 2019心得">
<meta name="twitter:description" content="這次是第一次參加iThome Kubernetes Summit，當初看到早鳥票釋出就直接買了($2400左右)，以一天的Conference來說不算便宜，但是能夠去學習學習增廣見聞也是值得的。 結果買票之後才得知我們社群Cloud Native Taiwan User Group(CNTUG)也有去擺攤，雖然是付費票，但是還是去支援了一下社群攤位xD。 上午場都在跟附近社群交流、逛攤位以及顧社群">
<meta name="twitter:image" content="https://i.imgur.com/AtBS9Xw.jpg">
  <link rel="canonical" href="https://pohsienshih.github.io/2019/2019-iThome-Kubernetes-Summit-Notes/">
<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>iThome Kubernetes Summit 2019心得 | Pohsien Workspace</title>
  <script async src="//www.googletagmanager.com/gtag/js?id=UA-150934951-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-150934951-1');
    }
  </script>
  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }
  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }
  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>
</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="default">
  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Pohsien Workspace</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">Cloud Native, Network, Security, etc.</h1>
  </div>
  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>
<nav class="site-nav">
    <ul id="menu" class="menu">
          <li class="menu-item menu-item-home">
    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>
  </li>
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>
  </li>
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>
  </li>
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>
  </li>
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>
  </li>
        <li class="menu-item menu-item-search">
            <a href="javascript:;" class="popup-trigger">
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
    </ul>
    <div class="site-search">
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>
    </div>
</nav>
</div>
    </header>
    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
  <div id="posts" class="posts-expand">
  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://pohsienshih.github.io/2019/2019-iThome-Kubernetes-Summit-Notes/">
    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pohsien Shih">
      <meta itemprop="description" content="System Engineer">
      <meta itemprop="image" content="/images/pohsien.jpg">
    </span>
    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Pohsien Workspace">
    </span>
      <header class="post-header">
          <h2 class="post-title" itemprop="name headline">iThome Kubernetes Summit 2019心得
          </h2>
        <div class="post-meta">
          <span class="post-time">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
                <span class="post-meta-item-text">Posted on</span>
              <time title="Created: 2019-09-16 21:11:58" itemprop="dateCreated datePublished" datetime="2019-09-16T21:11:58+08:00">2019-09-16</time>
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                  <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-12-12 21:31:18" itemprop="dateModified" datetime="2019-12-12T21:31:18+08:00">2019-12-12</time>
          </span>
            <span class="post-category">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
                <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a></span>
            </span>
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/2019-iThome-Kubernetes-Summit-Notes/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/2019-iThome-Kubernetes-Summit-Notes/" itemprop="commentCount"></span>
                </a>
              </span>
        </div>
      </header>
    <div class="post-body" itemprop="articleBody">
        <p>這次是第一次參加iThome Kubernetes Summit，當初看到早鳥票釋出就直接買了($2400左右)，以一天的Conference來說不算便宜，但是能夠去學習學習增廣見聞也是值得的。</p>
<p>結果買票之後才得知我們社群Cloud Native Taiwan User Group(CNTUG)也有去擺攤，雖然是付費票，但是還是去支援了一下社群攤位xD。</p>
<p>上午場都在跟附近社群交流、逛攤位以及顧社群攤位，因此只聽了第一場「賣K8s 的人不敢告訴你的事」。下午花比較多的時間在聽議程，以下列出部分議程的簡單心得跟筆記。<br><a id="more"></a></p>
<p>目前官方已經有將簡報釋出，也有釋出當天大會各議程共筆，有興趣的人可以參考：</p>
<p>議程: <a href="https://summit.ithome.com.tw/kubernetes/" target="_blank" rel="noopener">https://summit.ithome.com.tw/kubernetes/</a><br>大會共筆: <a href="https://hackmd.io/@k8ssummit/19/%2FRe80SUVITjWAMbUwaUVnWw" target="_blank" rel="noopener">https://hackmd.io/@k8ssummit/19/%2FRe80SUVITjWAMbUwaUVnWw</a></p>
<h2 id="賣-K8s-的人不敢告訴你的事"><a href="#賣-K8s-的人不敢告訴你的事" class="headerlink" title="賣 K8s 的人不敢告訴你的事"></a>賣 K8s 的人不敢告訴你的事</h2><p><strong>葉秉哲（William） / 新加坡商鈦坦科技 Technical Coach</strong><br><a href="http://bit.ly/k8s-vendor-secrets" target="_blank" rel="noopener">Slide</a></p>
<p>這場議程大多比較偏向使用者在導入Kubernetes時需要思考的事，大部分賣K8s平台的廠商在協助導入Kubernetes的時候都只提到好處(好管理Container以及好Scale)，但是都沒有提到維運成本以及其他層面(Networking, Storage etc)。</p>
<p>講者提到了在導入Kubernetes時，可以使用三種方式來更加了解及定位出自己的需求或目標：</p>
<h3 id="1-任何事情不能只看表面，要了解現實面。"><a href="#1-任何事情不能只看表面，要了解現實面。" class="headerlink" title="1. 任何事情不能只看表面，要了解現實面。"></a>1. 任何事情不能只看表面，要了解現實面。</h3><p>使用5W1H(What,Where,When,Why,Who,How)分析法去了解事情，要深入的去了解事情，不能只單單看表面，講者這裡提到一些例子：</p>
<p><a href="https://kubernetes.io" target="_blank" rel="noopener">Kubernetes官方對Kubernetes的介紹</a>：OpenSource、Auto-Deployment、Containerized等等。這個時候可以去思考：</p>
<ul>
<li>OpenSource如果出問題，有哪個廠商可以support嘛？</li>
<li>為什麼直到現在才有這種Auto-Deployment Container服務或著是跟現有的解決方案差別在哪？</li>
<li>我們真的做好自動化的準備嗎？我們的Service真的準備好Auto-Deployment了嗎？</li>
<li>為什麼會需要Containerized？</li>
<li>Service Containerized之後穩定嗎？</li>
<li>…</li>
</ul>
<p><a href="https://www.ithome.com.tw/voice/130643" target="_blank" rel="noopener">iThome 遍地開花的K8s與容器應用文章</a>，裡面提到K8s、容器化、微服務、部署跟管理方便以及Hybrid Cloud Solution等等。這個時候可以去思考：</p>
<ul>
<li>為什麼需要微服務? 優缺點是什麼？</li>
<li>什麼情況下會需要Hybrid Cloud Solution，以及為什麼以前沒有推這種Solution?</li>
<li>…</li>
</ul>
<p><a href="https://github.blog/2017-08-16-kubernetes-at-github/" target="_blank" rel="noopener">Kubernetes at GitHub</a>，GitHub在自家服務使用Kubernetes的成功案例，他們一開始先對<code>github.com</code>以及<code>api.github.com</code>導入Kubernetes，且第一階段先把stateless服務遷移到Kubernetes上。先選擇<code>github.com</code>以及<code>api.github.com</code>的原因是因為這兩個服務導入最艱難，只要這兩個導入成功的，其他的應該就比較沒問題。導入的工作主要是由是SRE、Platform以及Developer三個一起參與導入。看到這些可以去思考：</p>
<ul>
<li>為什麼導入要先以最艱難的服務導入？不是通常都會先用簡單或比較不重要的服務測試Kubernetes，然後再慢慢把重要的遷移上去嗎？GitHub這樣是有不同考量嗎？對我的企業而言哪種比較適合呢？</li>
<li>為什麼會需要SRE、Platform以及Developer三種工程師一起參與？缺少任一個可以嗎？</li>
<li>為何先挑選stateless服務做處理呢？</li>
</ul>
<h3 id="2-擴展自己的知識"><a href="#2-擴展自己的知識" class="headerlink" title="2. 擴展自己的知識"></a>2. 擴展自己的知識</h3><p>多擴展自己的知識，可以多看<a href="https://landscape.cncf.io/" target="_blank" rel="noopener">CNCF Cloud Native Interactive Landscape</a>，瞭解project的分類，並且定位自己目前需要達成的是哪些目標，多了解一些，不要冒然選廠商跟解決方案。</p>
<p>另外也可以參考<a href="https://github.com/cncf/trailmap" target="_blank" rel="noopener">CNCF Trail Map</a>，裡面有提供十個階段來建議企業漸進式導入Cloud Native專案，可以詢問自己目前想要做的是哪一階段或是廠商提供的是哪一階段的服務？</p>
<h3 id="3-Dev跟Ops都需要了解"><a href="#3-Dev跟Ops都需要了解" class="headerlink" title="3. Dev跟Ops都需要了解"></a>3. Dev跟Ops都需要了解</h3><p>要導入Kubernetes絕對不會只是Operation的事，Development也是相當重要的，善用各方面的知識，並且互相交流，才能夠降低導入Kubernetes的門檻。</p>
<h2 id="Docker-Swarm-太陽春-K8s-太複雜？試試輕量級的-K3s-吧！"><a href="#Docker-Swarm-太陽春-K8s-太複雜？試試輕量級的-K3s-吧！" class="headerlink" title="Docker Swarm 太陽春 K8s 太複雜？試試輕量級的 K3s 吧！"></a>Docker Swarm 太陽春 K8s 太複雜？試試輕量級的 K3s 吧！</h2><p><strong>王偉任（Weithenn） / Micron Technology Senior System Engineer</strong></p>
<p>這個議程主要是在介紹<a href="https://k3s.io/" target="_blank" rel="noopener">Rancher K3s</a>，提到K3s比起一般Kubernetes還要更加的輕量化及差異點(<code>SQLite</code>取代<code>etcd</code>,預設Container Runtime使用<code>containerd</code>)。由於他非常的輕量，因此很適合部署在如樹莓派這樣的IoT裝置上，且部署方式非常方便，也能夠整合Kubernetes預設的dashboard或是Rancher Dashboard來做管理。</p>
<h2 id="Harden-Your-Kubernetes-Cluster"><a href="#Harden-Your-Kubernetes-Cluster" class="headerlink" title="Harden Your Kubernetes Cluster"></a>Harden Your Kubernetes Cluster</h2><p><strong>蔡宗城（smalltown） / Maicoin Senior Site Reliability Engineer</strong><br><a href="https://www.slideshare.net/smalltown20110306/kubernetes-summit-2019?fbclid=IwAR11_q6pkSEmWNqv5c96n_poWUond5oe_e6CD4gTDF8vkHdkHxpO-ImuqhQ" target="_blank" rel="noopener">slide</a></p>
<p>此議程講者主要針對不同的層面來探討如何增強Kubernetes的安全性。講者提到了非常多實用的經驗跟工具，這裡有些部分沒有筆記到或是不清楚，建議可以直接看簡報比較詳細。</p>
<h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><ol>
<li>盡量使用Minimal Base Image，太大包的image可能會有不必要的套件，增加安全風險。</li>
<li>限制執行Container的使用者身份，以免讓Container取得過大的權限。</li>
<li>Image盡量不要使用<code>latest</code>版本，因為<code>latest</code>對應到的Image可能會一直變動。</li>
<li>不要隨意相信Registry上的Image，因為你無法確保那真的是官方釋出的。</li>
<li>可以使用簽章機制來識別官方釋出的Image，(可使用<code>Notary</code>)。</li>
<li>Image不要儲存一些敏感資訊，盡量用一些Secret形式來取代。</li>
<li>Use COPY instead of ADD</li>
<li>可使用 Anchor, Clair, Trivy來對image做CVE掃描，找出Image淺在的漏洞。</li>
<li>Regular Vulnerability Assessment -&gt; 評估跟分類掃瞄出來的漏洞</li>
<li>DevSecOps -&gt; 把image security 整合CI/CD。</li>
</ol>
<h3 id="Credential"><a href="#Credential" class="headerlink" title="Credential"></a>Credential</h3><ol>
<li>Kubernetes Secret放在Cluster裡不一定安全。</li>
<li>HashiCorp Vault -&gt; 管理credentials 生命週期及儲存，支援Dynamic Credentials，可以整合public cloud或是DB。</li>
<li>Credentials Lifecycle：不要把Credentials 存在Disk，可存在Memory，使用完就直接清掉，不要保存。</li>
</ol>
<h3 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h3><ol>
<li>預設情況下，Pod之間是沒有隔離的，網路都是互通。</li>
<li>Kubernetes Network Policy(須注意並不是每個CNI都有支援，slide裡連結有支援表可以參考)</li>
<li>Pod跟Pod之間傳輸是明碼的，很容易會有MITM。</li>
<li>Istio 裡面pod跟pod之間會有envoy proxy做傳輸，可以在這邊做手腳(Istio TLS)，將pod跟pod之間傳輸做加密。</li>
<li>Istio with Kiali ( 可以視覺化pod之間pod traffic流量，也會顯示連線是否有加密。</li>
</ol>
<h3 id="Runtime-pod底層"><a href="#Runtime-pod底層" class="headerlink" title="Runtime(pod底層)"></a>Runtime(pod底層)</h3><p>分成兩個部分 Auditing &amp; Enforcement</p>
<ol>
<li>Enforcement -&gt; 強迫去做一些事情(pod security policy, aurmor)</li>
<li>Falco -&gt; 限定使用者不能做什麼事，例如使用者想要exec到pod執行bash，動作就會被擋住，然後Falco會傳通知給administrator。</li>
</ol>
<h3 id="Policy-as-Code"><a href="#Policy-as-Code" class="headerlink" title="Policy as Code"></a>Policy as Code</h3><ol>
<li>Open Policy Agent (Kubernetes Admission Control, HTTP API Authorization)</li>
<li>OPA Flow，有點類似會有一個authorization/authentication server去對權限做管理，k8s在執行任何動作前都會去問authorization server來決定可不可以執行。</li>
<li>需注意OPA不是使用yaml來撰寫，是自己的語法。</li>
</ol>
<h2 id="前方有雷別再踩─企業導入-Kubernetes-的掃雷指南"><a href="#前方有雷別再踩─企業導入-Kubernetes-的掃雷指南" class="headerlink" title="前方有雷別再踩─企業導入 Kubernetes 的掃雷指南"></a>前方有雷別再踩─企業導入 Kubernetes 的掃雷指南</h2><p><strong>朱培華 / 多奇數位創意系統工程師</strong></p>
<p>此議程的講者整理了非常多的Kubernetes Best Practice，從update, scaling, secret管理到label應用、資源應用以及監控等等，非常多實用的內容，這部分因為一些原因沒有記錄太多筆記，不過講者的簡報相當詳細，因此建議可以直接參考簡報。</p>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p>這裡筆者只列出一些議程筆記，其他比較偏安裝教學或是有些沒有筆記到的就沒有寫在這上面，有興趣者可以參考官方的共筆或是簡報。</p>
<p>這次參加的感想是議程部分比較入門類，偏向經驗分享或是工具使用教學，很適合像筆者這樣的菜鳥新手去聽。攤位部分不多，大概只有幾家比較大的贊助商來擺攤，不過廠商贈品送的還蠻多的，另外這次很特別的是有來自國外的Dr.Brad Topol簽書會(書名<a href="https://www.ibm.com/account/reg/us-en/signup?formid=urx-34925" target="_blank" rel="noopener">Kubernetes in the Enterprise</a>)，只要用名片就可以換到一本原文簽名書，算是這次Conference中最佛心的活動。</p>
<p>最後還是覺得票價不便宜，希望明年有機會能夠當講者，除了能累積經驗外，也能使用講者票參加，一舉數得。</p>
<p>\<br><strong>Cloud Native Taiwan User Group攤位</strong></p>
<p><img src="https://i.imgur.com/AtBS9Xw.jpg" alt></p>
<p><strong><code>Kubernetes in the Enterprise</code>作者簽書會</strong><br><img src="https://i.imgur.com/kBoSZXs.jpg" alt></p>
<div class="note info">
            <p>文章內容的轉載、重製、發佈，請註明出處: <a href="https://pohsienshih.github.io">https://pohsienshih.github.io</a></p>
          </div>
    </div>
    <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/conference/" rel="tag"># conference</a>
        </div>
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
              <a href="/2019/Enterprise-PKS-K8s-Node-Disk-Out-Of-Space/" rel="next" title="針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法">
                <i class="fa fa-chevron-left"></i> 針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法
              </a>
          </div>
          <span class="post-nav-divider"></span>
          <div class="post-nav-prev post-nav-item">
              <a href="/2019/ELK-Filebeat-With-Log-Rotate/" rel="prev" title="ELK Filebeat With Log Rotate">
                ELK Filebeat With Log Rotate <i class="fa fa-chevron-right"></i>
              </a>
          </div>
        </div>
    </footer>
  </div>
  </article>
  </div>
          </div>
     <div class="comments" id="comments">
      <div id="disqus_thread"></div>
      <script>
      /**
      *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
      *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
      var disqus_config = function () {
      this.page.url = "https://pohsienshih.github.io/2019/2019-iThome-Kubernetes-Summit-Notes/"; // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "2019/2019-iThome-Kubernetes-Summit-Notes/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://pohsien-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
        </div>
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>
  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
              <img class="site-author-image" itemprop="image" src="/images/pohsien.jpg" alt="Pohsien Shih">
              <p class="site-author-name" itemprop="name">Pohsien Shih</p>
              <div class="site-description motion-element" itemprop="description">System Engineer</div>
          </div>
            <nav class="site-state motion-element">
                <div class="site-state-item site-state-posts">
                  <a href="/archives/">
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
                <div class="site-state-item site-state-categories">
                      <a href="/categories/">
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
                <div class="site-state-item site-state-tags">
                      <a href="/tags/">
                    <span class="site-state-item-count">10</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
            </nav>
            <div class="links-of-author motion-element">
                <span class="links-of-author-item">
                  <a href="https://github.com/pohsienshih" title="GitHub &rarr; https://github.com/pohsienshih" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
                <span class="links-of-author-item">
                  <a href="mailto:pohsien324@gmail.com" title="E-Mail &rarr; mailto:pohsien324@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
            </div>
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                相關連結
              </div>
              <ul class="links-of-blogroll-list">
                  <li class="links-of-blogroll-item">
                    <a href="https://k2r2bai.com/" title="https://k2r2bai.com/" rel="noopener" target="_blank">凱仁大大</a>
                  </li>
                  <li class="links-of-blogroll-item">
                    <a href="https://www.hwchiu.com/" title="https://www.hwchiu.com/" rel="noopener" target="_blank">邱牛大大</a>
                  </li>
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.pichuang.com.tw/" title="https://blog.pichuang.com.tw/" rel="noopener" target="_blank">小飛機</a>
                  </li>
                  <li class="links-of-blogroll-item">
                    <a href="https://www.facebook.com/groups/cloudnative.tw/" title="https://www.facebook.com/groups/cloudnative.tw/" rel="noopener" target="_blank">CNTUG</a>
                  </li>
                  <li class="links-of-blogroll-item">
                    <a href="Chttps://medium.com/@b02310043" title="Chttps://medium.com/@b02310043" rel="noopener" target="_blank">莫阿兆</a>
                  </li>
              </ul>
            </div>
        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#賣-K8s-的人不敢告訴你的事"><span class="nav-number">1.</span> <span class="nav-text">賣 K8s 的人不敢告訴你的事</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-任何事情不能只看表面，要了解現實面。"><span class="nav-number">1.1.</span> <span class="nav-text">1. 任何事情不能只看表面，要了解現實面。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-擴展自己的知識"><span class="nav-number">1.2.</span> <span class="nav-text">2. 擴展自己的知識</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Dev跟Ops都需要了解"><span class="nav-number">1.3.</span> <span class="nav-text">3. Dev跟Ops都需要了解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-Swarm-太陽春-K8s-太複雜？試試輕量級的-K3s-吧！"><span class="nav-number">2.</span> <span class="nav-text">Docker Swarm 太陽春 K8s 太複雜？試試輕量級的 K3s 吧！</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Harden-Your-Kubernetes-Cluster"><span class="nav-number">3.</span> <span class="nav-text">Harden Your Kubernetes Cluster</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Image"><span class="nav-number">3.1.</span> <span class="nav-text">Image</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Credential"><span class="nav-number">3.2.</span> <span class="nav-text">Credential</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Network"><span class="nav-number">3.3.</span> <span class="nav-text">Network</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Runtime-pod底層"><span class="nav-number">3.4.</span> <span class="nav-text">Runtime(pod底層)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Policy-as-Code"><span class="nav-number">3.5.</span> <span class="nav-text">Policy as Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#前方有雷別再踩─企業導入-Kubernetes-的掃雷指南"><span class="nav-number">4.</span> <span class="nav-text">前方有雷別再踩─企業導入 Kubernetes 的掃雷指南</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#總結"><span class="nav-number">5.</span> <span class="nav-text">總結</span></a></li></ol></div>
          </div>
        </div>
      <!--/noindex-->
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
        </div>
    </div>
  </aside>
      </div>
    </main>
    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pohsien Shih</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a></div>
      </div>
    </footer>
  </div>
<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
  <script src="/lib/jquery/index.js?v=2.1.3"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="/js/utils.js?v=7.1.1"></script>
  <script src="/js/motion.js?v=7.1.1"></script>
  <script src="/js/affix.js?v=7.1.1"></script>
  <script src="/js/schemes/pisces.js?v=7.1.1"></script>
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>
  <script src="/js/next-boot.js?v=7.1.1"></script>
  <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
<script>
  var disqus_config = function() {
    this.page.url = "https://pohsienshih.github.io/2019/2019-iThome-Kubernetes-Summit-Notes/";
    this.page.identifier = "2019/2019-iThome-Kubernetes-Summit-Notes/";
    this.page.title = 'iThome Kubernetes Summit 2019心得';
    };
  function loadComments() {
    var d = document, s = d.createElement('script');
    s.src = 'https://.disqus.com/embed.js';
    s.setAttribute('data-timestamp', '' + +new Date());
    (d.head || d.body).appendChild(s);
  }
    loadComments();
</script>
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }
    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');
      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }
                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }
                // show search results
                if (isMatch) {
                  // sort index by position of keyword
                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });
                  // merge hits into slices
                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;
                      // move to next position of hit
                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }
                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }
                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }
                  // sort slices in content by search text's count and hits' count
                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });
                  // select top N slices in content
                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }
                  // highlight title and content
                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }
                  var resultItem = '';
                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }
                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });
                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }
          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }
          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');
          proceedsearch();
        }
      });
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>
<script>
  $('.highlight').not('.gist .highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('Copy');
      }, 300);
    }).append(e);
  })
</script>
</body>
</html>
